export K8S_SERVICES="tds-alpine tds-rconnector tds-notebooks tds-chorus nfs-subdir-external-provisioner"

function klogs() {
  serviceName="$1"
  shift
  kubectl logs "service/$serviceName" -f "$@"
}

function kexecProc() {
  serviceName="$1"
  shift
  if [ -n "$1" ]; then
    kubectl exec -it "service/$serviceName" "$@"
  else
    kubectl exec -it "service/$serviceName" -- /bin/bash
  fi
}

function kcleanReplicas() {
  emptyReplicasets="`kubectl get replicasets | grep '0[ ]\+0[ ]\+0' | cut -d' ' -f 1`"
  if [ -n "$emptyReplicasets" ]; then
    kubectl delete replicasets $emptyReplicasets
  fi
}

function kstopAll() {
  for d in $K8S_SERVICES; do
    kubectl scale --replicas=0 "deployment/$d"
  done
}

function kstartAll() {
  if systemctl status dnsmasq 2>/dev/null >/dev/null; then
    sudo systemctl restart dnsmasq
  fi
  for d in $K8S_SERVICES; do
    kubectl scale --replicas=1 "deployment/$d"
  done
}
